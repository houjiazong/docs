---
title: "其它组件"
weight: 3
date: 2019-07-09T15:55:31+08:00
---

当控制节点部署完成后，还有其它容器化的组件可以部署，比如 glance, baremetal 和 webconsole 等，可以根据需要部署到其它节点，或者为了方便把这些组件都部署在控制节点。

## 组件部署在控制节点

可以把所有组件都部署在已有的控制节点，参考: [组件安装](/setup/components/#组件安装)

## 组件部署到其它节点

如果需要把组件部署到其它节点，需要先在待部署的节点启动 kubelet，把改节点加入到已有的 kubernetes 集群，然后启动对应的容器化组件。

### 环境准备

参考"部署控制节点"的流程，部署好 docker 和 kubelet，然后在控制节点使用 ocadm 拿到加入集群的 token，在待部署节点使用 ocadm 加入集群，操作如下:

- 在控制节点获取加入节点的 token

```bash
$ ocadm token list | grep bootstrap
4s4meb.xvgk2bwpmbospn3s   23h       2019-07-10T15:41:10+08:00   authentication,signing   The default bootstrap token generated by 'ocadm init'.   system:bootstrappers:kubeadm:default-node-token
```

- 在待部署节点使用 token 加入 kubernetes 集群

```bash
# 这里的 10.168.222.216 是控制节点的 ip，请根据你的环境修改
$ ocadm join 10.168.222.216:6443 --token 4s4meb.xvgk2bwpmbospn3s --discovery-token-unsafe-skip-ca-verification
...
This node has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run 'kubectl get nodes' on the control-plane to see this node join the cluster.
```

## 组件安装

`ocadm component install` 可以安装全部的组件，或者根据选择将不同的组件安装到不同的节点。

全部安装之前需要安装各个组件的依赖，目前只有 baremetal 依赖 baremetal-pxerom，这个包里面有物理机 pxe 启动时需要的引导文件、kernel 和 initramfs。

```bash
# 安装依赖
$ yum install -y https://iso.yunion.cn/yumrepo-2.10/baremetal/baremetal-pxerom-1.1.0-19061318.x86_64.rpm
# 全部安装
$ ocadm component install all

# 安装 glance
$ ocadm component install glance

# 安装 baremetal，如果没有安装 baremetal-pxerom 需要通过 yum 安装
$ ocadm component install baremetal
```
